@page
@model Aeon_Web.Areas.Project.Pages.Job.ListModel
@{
    ViewData["Title"] = "üî• –ü—Ä–æ–µ–∫—Ç—ã –º–µ—á—Ç—ã";
}

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"/>
<link rel="stylesheet" href="~/css/areas/project/list.css"/>
<link rel="stylesheet" href="~/css/areas/project/star.css"/>
<script src="~/js/render-stars.js"></script>

<div class="body">
    <section class="container">
        <form method="get" class="filter-bar">
            <div class="search-group">
                <i class="fas fa-search"></i>
                <input type="text" name="SearchQuery" value="@Model.SearchQuery" placeholder="–ü–æ–∏—Å–∫ –ø—Ä–æ–µ–∫—Ç–æ–≤..."/>
            </div>

            <div class="select-group">
                <i class="fas fa-star"></i>
                <select name="MaxDifficulty">
                    <option value="">–õ—é–±–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å</option>
                    @for (var i = 1; i <= 5; i++)
                    {
                        var i1 = i * 2;
                        var i2 = i;
                        <option value="@i1" selected="@(Model.MaxDifficulty == i1)">
                            –î–æ @i2 ‚≠ê
                        </option>
                    }
                </select>
            </div>

            <button type="submit" class="filter-btn">
                –ù–∞–π—Ç–∏
            </button>
        </form>
        
        @if (Model.Vacancies.Count == 0)
        {
            <h2>–ù–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ</h2>
        }
        else
        {
            <h1 class="headline">üî• –ê–∫—Ç—É–∞–ª—å–Ω—ã–µ –ø—Ä–æ–µ–∫—Ç—ã</h1>

            @*TODO –¥–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –Ω–∞ null*@
            <div class="job-grid">
                @foreach (var vacancy in Model.Vacancies)
                {
                    <div class="job-card">
                        <a asp-area="Project" asp-page="/Job/Details" asp-route-vacancyId="@vacancy.Id">
                            <div class="card-header">
                                <h2>@vacancy.Title</h2>
                            </div>
                            <div class="meta">
                                <div class="star-display" data-rating="@vacancy.DifficultyLevel">
                                    @for (var i = 1; i <= 5; i++)
                                    {
                                        <span class="star" data-star="@i"></span>
                                    }
                                </div>
                            </div>
                            <p class="description">@(vacancy.Description[..Math.Min(120, vacancy.Description.Length)])...</p>
                            <div class="skills">
                                @foreach (var skill in vacancy.VacancySkills.Take(5))
                                {
                                    <span class="skill">@skill.Skill?.Name</span>
                                }
                            </div>
                            <a class="view-button" asp-page="/Job/Details" asp-route-vacancyId="@vacancy.Id">–ü–æ–¥—Ä–æ–±–Ω–µ–µ</a>
                        </a>
                    </div>
                }
            </div>
        }
    </section>
</div>
